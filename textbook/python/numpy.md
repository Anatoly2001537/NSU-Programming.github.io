---
title: Вычисления с библиотекой numpy
menu: textbook-python
---

Библиотека [`numpy`](https://numpy.org/) является основой экосистемы python для научных вычислений. В основе `numpy` лежит код на языке C, обеспечивающий высокую производительность. Центральным объектом в `numpy` является многомерный массив `numpy.ndarray`. Разнообразие и удобство инструментов для работы с /многомерными массивами позволяют очень быстро реализовывать разнообразные вычислительные процедуры с минимальным количеством кода и во многих случаях без использования циклов.

## Создание и свойства объектов numpy.ndarray

Массив `numpy` можно создать из списка чисел:

```py
import numpy as np
a = np.array([1, 2, 3])
a.ndim   # 1
a.shape  # (3,)
a.size   # 3
a.dtype  # np.int64
a[0]     # 1
```

Двумерный массив из списка списков:

```py
import numpy as np
b = np.array([
    [1, 2, 3.],
    [4, 5, 6]
])
b.ndim   # 2
b.shape  # (3, 3)
b.size   # 6
b.dtype  # np.float64
b[0]     # [1., 2., 3.]
b[0, 0]  # 1.
b[:, 0]  # [1., 4.]
```

Количество измерений может быть любым. В `numpy` есть несколько функций, для быстрого создания массовов:

```py
# трехмерный массив с типом элементов np.float64, заполненный нулями
zeros = np.zeros(shape=(3, 3, 3), dtype=np.float64)
# двумерный массив целых чисел, заполненный единицами
ones = np.zeros((3, 3), dtype=np.int64)
# не проинициализированный четырехмерный массив комплексных чисел
empty = np.empty((4, 4, 4, 4), dtype=np.complex128)
# единичная матрица 3x3
unit3 = np.eye(3)
# диагональная матрица 4x4
diag4 = np.diag([1, 2, 3, 4])
# матрица 4x4, заполненная послеодвательными целыми числами
mtx = np.arange(16).reshape(-1, 4)
```

В последнем примере мы использовали метод [`reshape`](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.reshape.html), позволяющий изменить форму массива. Для успешного выполнения этой операции массив должен содержать подходящее количество элементов. В качестве первого аргумента мы передали `-1`. Это значит, что первая размерность должна быть получена автоматически из известного размера массива и значения второй размерности: `16 // 4 = 4`.

Метод `reshape` не изменяет объект, у которого он вызван. Кроме того, если это возможно, метод `reshape` не выполняет копирование данных. Вместо этого он возвращает новое *представление* (view) массива. Такое поведение очень удобно при работе с большими массивами, но надо иметь его в виду при изменении объекта через разные представления:

```py
a = np.arange(6).reshape(-1, 2)
# [[0, 1],
#  [2, 3],
#  [4, 5]]
b = a.reshape(-1, 3)
# [[0, 1, 2],
#  [3, 4, 5]]
b[0, 0] = 9
# [[9, 1, 2],
#  [3, 4, 5]]
print(a)
# [[9, 1],
#  [2, 3],
#  [4, 5]]
```

<!-- Если вместо `reshape` использовать [`resize`](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.resize.html), то изменения будут выполнены на месте. Метод `resize` требудет больше операций и используется реже, чем `reshape`. -->

<!-- Как и для многих методов класса `np.ndarray`, в `numpy` оперделены функции-аналоги [`np.reshape`](https://numpy.org/doc/stable/reference/generated/numpy.resize.html) и [`np.resize`](https://numpy.org/doc/stable/reference/generated/numpy.reshape.html), которые имеют тот же смысл, что и методы. -->

<!-- Методы [`flatten`](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.flatten.html) и [`ravel`](https://numpy.org/doc/stable/reference/generated/numpy.ravel.html) позволяют получить одномерную версию массива любой формы. При этом, `flatten` возвращает копию данных, а `ravel` возвращает представление, если это возможно. -->

Метод [`ravel`](https://numpy.org/doc/stable/reference/generated/numpy.ravel.html) позволяет получить одномерное представления массива любой формы. Как и `reshape`, `ravel` не выполняет копирование, если это возможно. Действие `ravel` аналогично вызову `reshape(-1)`.

## Операции с массивами, broadcasting

С массивами `numpy` работают все арифметические операции, причем происходит в большинстве

## Способы индексации

## Случайные числа в numpy

## Линейная алгебра в numpy

### np.einsum

## Источники

* [numpy.org/doc/stable/](https://numpy.org/doc/stable/)
* [Numpy quickstart tutorial](https://numpy.org/doc/stable/user/quickstart.html)
* [Scipy Lecture Notes](https://scipy-lectures.org/)
